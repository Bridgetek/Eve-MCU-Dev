# EVE-MCU-Dev Simple Example

[Back](../README.md)

## Simple Example

The `simple` example demonstrates detection of a touch event on a display item, and loading both a custom font and a bitmap into RAM_G. 

The custom font provides a character set that contains the numbers 0 to 9 resembling a 7 segment LED. The font is called DS-FONT. A touch event detected on the numbers will increase the number displayed. A BridgeTek logo is loaded as a bitmap and displayed above the counter.

This example supports the following platforms:

| Port Name | Port Directory | 
| --- | --- | 
|Bridgetek FT9xx | [ft900](ft900/README.md) | 
|Beaglebone Black | [BeagleBone](BeagleBone/README.md) (1) | 
|Expressif ESP32 | [ESP32](ESP32/README.md) | 
|TI MSP430 | [MSP430](MSP430/README.md) (1) |
|TI MSPM0 | [MSPM0](MSPM0/README.md) (1) | 
|Microchip PIC18F | PIC18F (1) | 
|ST STM32 (Keil) | [STM32](STM32/README.md) (1) | 
|ST STM32Cube | [STM32CUBE](STM32CUBE/README.md) (1) | 
|Raspberry Pi | [raspberry_pi](raspberry_pi/README.md) | 
|Raspberry Pi Pico (SDK) | [pico](pico/README.md) | 
|Raspberry Pi Pico (VS Code) | [pico_vscode](pico_vscode/README.md) |
|Generic using libMPSSE CMake | [libft4222](libft4222/README.md) | 
|Generic using libMPSSE Visual Studio | [libft4222](libft4222/README.md) | 
|Generic using libFT4222 CMake | [libmpsse](libmpsse/README.md) | 
|Generic using libFT4222 Visual Studio | [libmpsse](libmpsse/README.md) | 

- (1) Hardware testing ongoing.
 
Supported EVE APIs in this example:

| EVE API 1 | EVE API 2 | EVE API 3 | EVE API 4 | EVE API 5 |
| --- | --- | --- | --- | --- |
| Yes | Yes | Yes | Yes | Yes |

The following is an screenshot of the simple example.

![Simple Example](docs/simple.png)

### `main.c`

The application starts up in the file `main.c` which provides initial MCU configuration and then calls `eve_example.c` where the remainder of the application will be carried out. 

The `main.c` code is platform specific. It must provide any functions that rely on a platform's operating system, or built-in non-volatile storage mechanism. The required functions store and recall previous touch screen calibration settings:
- **platform_calib_init** initialise a platform's non-volatile storage system.
- **platform_calib_read** read a previous touch screen calibration or return a value indicating that there are no stored calibration setting.
- **platform_calib_write** write a touch screen calibration to the platform's non-volatile storage.

The example program in the common code is then called.

### `eve_example.c`

In the function `eve_example` the basic format is as follows:

```
void eve_example(void)
{
    uint32_t font_end;
    // Initialise the display
    EVE_Init();
    // Calibrate the display
    eve_calibrate();
    // Load fonts and images
    font_end = eve_init_fonts();
    eve_load_images(font_end);
    // Start example code
    eve_display();
 }
```
The call to `EVE_Init()` is made which sets up the EVE environment on the platform. This will initialise the SPI communications to the EVE device and set-up the device ready to receive communication from the host.

Next, the function `eve_calibrate()` is then called which uses the calibration co-processor command to display the calibration screen and asks the user to tap the three dots (see `eve_calibrate.c` below).

Once calibration is complete, the font for the counter and the image for the logo are both loaded  (see `eve_fonts.c` and `eve_images.c` below).
Finally, the main program sits in a continuous loop within `eve_display()`. Each time round the loop, a screen is created using a co-processor list. 

### `eve_calibrate.c`

This function is used to show the touchscreen calibration screen and prompt the user to touch the screen at the required positions to generate an accurate transformation matrix. This matrix is used to translate the raw touch input into precise points on the screen.

The platform specific functions in `main.c` are called from this routine to store and read touchscreen calibration settings so that the user only needs to perform the action once.

### `eve_fonts.c`

This file contains the data array of a font which was produced by the Font Converter tool which is part of EVE Asset Builder. The code in this file will send the commands to the coprocessor to load the font into RAM_G and set-up the font for use.

### `eve_images.c`

The BridgeTek logo is stored in an array in this file. It is loaded into RAM_G and the commands to setup the image are loaded into a display list. The array in this file contains as a JPEG image of the logo. 

Any valid image image format can be used to 
bitmap generated by the Images Tool in the EVE Asset Builder. In 

## Files and Folders

The example contains a common directory with several files which comprises all the demo functionality.

| File/Folder | Description |
| --- | --- |
| [common/eve_example.c](common/eve_example.c) | Example source code file |
| [common/eve_calibrate.c](common/eve_calibrate.c) | Calibrations routines |
| [common/eve_fonts.c](common/eve_fonts.c) | Font helper routines |
| [common/eve_helper.c](common/eve_helper.c) | General helper routines (touch detection) |
| [common/eve_images.c](common/eve_images.c) | Image helper routines |
| [docs](docs) | Documentation support files |
